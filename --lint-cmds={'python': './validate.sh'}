from flask import Flask, request, render_template, jsonify
import datetime
from ai_logic import generate_qa_pair
from data_handler import save_card, load_cards

app = Flask(__name__)

@app.route('/')
def index():
    cards = load_cards()
    return render_template('index.html', cards=cards)

@app.route('/submit', methods=['POST'])
def submit():
    thought = request.form.get('thought')
    if not thought:
        return jsonify({'status': 'error', 'message': 'Thought is required'}), 400
    
    try:
        question, answer = generate_qa_pair(thought)
        timestamp = datetime.datetime.now().isoformat()
        save_card(question, answer, timestamp)
        return jsonify({'status': 'success'})
    except Exception as e:
        return jsonify({'status': 'error', 'message': str(e)}), 500

if __name__ == '__main__':
    app.run(debug=True)
